<!doctype html>
<meta name="Content-Type" content="text/html; charset=UTF-8">
<title>Try ACL2</title>
<script type="text/javascript"
  src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.4/jquery.min.js">
</script>
<script type="text/javascript" src="jquery.console.js"></script>
<script type="text/javascript">
  sid = Math.random()
  function parens_match(line) {
    opens = line.match(/\(/g);
    open_cnt = (opens ? opens.length : 0);
    closes = line.match(/\)/g);
    close_cnt = (closes ? closes.length : 0);
    return open_cnt - close_cnt;
  }
  var consoleCancelFlag = false;
  $(document).ready(function(){
      jq_console = $('#console');
      controller = jq_console.console({
       autofocus: true,
       promptLabel: '> ',
       commandValidate:function(line){
         if (line == "") return false;
         else return true;
       },
       commandHandle: function(line, report) {
        paren_count = parens_match(line);
        if (paren_count > 0) {
          controller.continuedPrompt = true;
          return;
        } else if (paren_count < 0) {
          report([{msg:"Unmatched ')'", className:"error"}]);
          return;
        }
        controller.continuedPrompt = false;
        $.get('', {code: line, sid: sid}, function(data) {
            if(!consoleCancelFlag)
              report(data);
            else {
              report([{msg:"User interrupt",
                className:"error"}]);
                consoleCancelFlag = false;
            }
            inner = $('.jquery-console-inner')[0]
            inner.scrollTop = inner.scrollHeight;
        });
       },
       cancelHandle:function() {
           consoleCancelFlag = true;
       },
       animateScroll:true,
       promptHistory:true
     });
   });
</script>
<style type="text/css" media="screen">
  #console ::-webkit-scrollbar {
    width: 10px;
  }
  #console ::-webkit-scrollbar-track {
    background: #eee;
  }
  #console ::-webkit-scrollbar-thumb {
    background: #94C740;
  }
  html {
    background: #eee;
    height: 100%;
    width: 100%;
    padding: 0;
    margin: 0;
    font-family: monospace;
  }
  body {
    border-radius: 3px;
    font-size: 10pt;
    height: 99%;
    background: #94C740;
    width: 600px;
    margin: 4px auto;
    -webkit-box-shadow: 0 0 5px #888;
    -moz-box-shadow: 0 0 5px #888;
    box-shadow: 0 0 8px #888;
  }
  #console {
    background: white;
    border-width: 1px 0;
    border: solid #888 1px;
    height: 50%;
    padding: 6px;
  }
  h1 {
    margin: 0;
    padding: 4px 0 2px 4px;
    color: #335;
  }
  #console .jquery-console-inner {
    height: 100%;
    overflow: auto;
  }
  #console .jquery-console-prompt-box {
    color: #444;
  }
  #console .jquery-console-focus span.jquery-console-cursor {
    background: #333;
    color: #eee;
    font-weight: bold
  }
  #console .error {
    color: #ef0505;
    font-weight: bold;
    padding: 0.1em;
  }
  #console .jquery-console-message {
    max-height: 200px;
    overflow: auto;
    margin: 5px 20px;
    white-space: pre;
    white-space: pre-wrap;
    word-wrap: break-word;
  }
  #console span.jquery-console-prompt-label {
    font-weight: bold;
  }
  #help {
    padding: 10px
  }
</style>
<h1>Try ACL2</h1>
<div id="console"></div>
<div id="help">
  Some things to try:
  <ul>
    <li> (+ 1 1)
    <li> (append '(1 2 3) '(4 5 6))
    <li> (thm (= (+ a b) (+ b a)))
    <li> (defun fact (n) (if (zp n) 1 (* n (fact (- n 1)))))
    <li> (defun sum (xs) (if (endp xs) 0 (+ (first xs) (sum (rest xs)))))
    <li> (thm (= (sum (append xs ys)) (+ (sum xs) (sum ys))))
  </ul>
</div>
